<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>React 移动端总结 | 随时奉陪</title><meta name="author" content="随时奉陪"><meta name="copyright" content="随时奉陪"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="React 移动端总结该项目主要使用 react、redux、antd-mobile、axios、react-router、sass、ts、ahooks 库、lodash、websocket 等  antd-mobileantd-mobile 是 Ant Design 的移动规范的 React 实现"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://metabo6.github.io/posts/cd25c3da"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'React 移动端总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-24 10:51:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly/index.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-tags"></i><span> 仿 win10</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-folder-open"></i><span> 学习资料</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-fish"></i><span> 摸鱼</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-anchor"></i><span> 动画</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-place-of-worship"></i><span> 摸鱼大军</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-link"></i><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/react.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">随时奉陪</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-tags"></i><span> 仿 win10</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-folder-open"></i><span> 学习资料</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-fish"></i><span> 摸鱼</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-tools"></i><span> 工具</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-anchor"></i><span> 动画</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-place-of-worship"></i><span> 摸鱼大军</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-link"></i><span> 友人帐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">React 移动端总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-24T02:22:36.000Z" title="发表于 2022-11-24 10:22:36">2022-11-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-24T02:51:53.608Z" title="更新于 2022-11-24 10:51:53">2022-11-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>24分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="React 移动端总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="React-移动端总结"><a href="#React-移动端总结" class="headerlink" title="React 移动端总结"></a>React 移动端总结</h1><p>该项目主要使用 react、redux、antd-mobile、axios、react-router、sass、ts、ahooks 库、lodash、websocket 等 </p>
<h2 id="antd-mobile"><a href="#antd-mobile" class="headerlink" title="antd-mobile"></a>antd-mobile</h2><p>antd-mobile 是 Ant Design 的移动规范的 React 实现，服务于蚂蚁及口碑无线业务。</p>
<p><strong>使用</strong>：</p>
<ol>
<li>下包</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add antd-mobile</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>按需导入即可使用</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd-mobile&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Login</span> = (<span class="params"></span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">color</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>Button<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h3 id="antd-mobile主题定制"><a href="#antd-mobile主题定制" class="headerlink" title="antd-mobile主题定制"></a>antd-mobile主题定制</h3><p><a target="_blank" rel="noopener" href="https://mobile.ant.design/zh/guide/theming">antd-mobile 主题</a></p>
<p>src&#x2F;index.scss 中：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--adm-color-primary</span>: <span class="number">#fc6627</span>;</span><br><span class="line">  <span class="attr">--adm-color-success</span>: <span class="number">#00b578</span>;</span><br><span class="line">  <span class="attr">--adm-color-warning</span>: <span class="number">#ff8f1f</span>;</span><br><span class="line">  <span class="attr">--adm-color-danger</span>: <span class="number">#ff3141</span>;</span><br><span class="line">  <span class="attr">--adm-color-white</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attr">--adm-color-weak</span>: <span class="number">#999999</span>;</span><br><span class="line">  <span class="attr">--adm-color-light</span>: <span class="number">#cccccc</span>;</span><br><span class="line">  <span class="attr">--adm-border-color</span>: <span class="number">#eeeeee</span>;</span><br><span class="line">  <span class="attr">--adm-font-size-main</span>: <span class="number">13px</span>;</span><br><span class="line">  <span class="attr">--adm-color-text</span>: <span class="number">#333333</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="CSS-变量"><a href="#CSS-变量" class="headerlink" title="CSS 变量"></a>CSS 变量</h2><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Using_CSS_custom_properties">CSS变量-自定义属性</a></p>
<p>CSS 自定义属性，通常称为 <code>CSS 变量</code>。类似于 JS 中声明的变量，可以<strong>复用 CSS 属性</strong>值。其变量有作用域之分。</p>
<p><strong>定义格式</strong> ： <code>变量名：值</code> </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1 创建全局 CSS 变量 --geek-color-primary*/</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--geek-color-primary</span>: <span class="number">#fc6627</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两个–开头</p>
<p><strong>使用格式</strong>:  <code>属性名: val(变量名)</code></p>
<p>示例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 2 复用 */</span></span><br><span class="line">.<span class="property">list</span>-item-active &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="title function_">var</span>(--geek-color-primary);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>根据 CSS 变量的作用域，分为两种：</p>
<ol>
<li>全局 CSS 变量：全局有效</li>
<li>局部 CSS 变量：只在某个作用域内（比如，某个类名中）有效</li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  全局 CSS 变量</span></span><br><span class="line"><span class="comment">  1. 使用 :root 这个 CSS 伪类匹配文档树的根元素 html。可以在 CSS 文件的任意位置使用该变量</span></span><br><span class="line"><span class="comment">     相当于 JS 变量中的全局</span></span><br><span class="line"><span class="comment">  2. CSS 变量通过两个减号（--）开头，多个单词之间推荐使用 - 链接。CSS 变量名可以是任意变量名</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--geek-color-primary</span>: <span class="number">#fc6627</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 使用 */</span></span><br><span class="line"><span class="selector-class">.tabs-item-active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--geek-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.list-item-active</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--geek-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">  局部 CSS 变量</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.list</span> &#123;</span><br><span class="line">  <span class="attr">--active-color</span>: <span class="number">#1677ff</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 在该 类 内部使用改变量 */</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--active-color);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.test</span> &#123;</span><br><span class="line">  <span class="comment">/* 这里的错误演示：无效！效果与不使用该变量时一致*/</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--active-color); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="craco"><a href="#craco" class="headerlink" title="craco"></a>craco</h2><p>与 pc 项目基本一致，下包后可自定义项目配置</p>
<ol>
<li>下包</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add  @craco/craco</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建并配置 <code>craco.config.js</code> 文件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// webpack 配置</span></span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="comment">// 配置别名</span></span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="comment">// 约定：使用 @ 表示 src 文件所在路径</span></span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>),</span><br><span class="line">      <span class="comment">// 约定：使用 @scss 表示 样式 文件所在路径</span></span><br><span class="line">      <span class="string">&#x27;@scss&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;assets&#x27;</span>, <span class="string">&#x27;styles&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>package.json </code>中修改命令</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将 start/build/test 三个命令修改为 craco 方式</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco start&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco build&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco test&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="tsconfig-json"><a href="#tsconfig-json" class="headerlink" title="tsconfig.json"></a>tsconfig.json</h2><p>项目使用了 TS，而 TS 带有配置文件 tsconfig.json。因此，不需要再使用 jsconfig.json</p>
<p>VSCode 会自动读取 <code>tsconfig.json</code> 中的配置，让 vscode 知道 @ 就是 src 目录</p>
<p>创建并配置 <code>path.tsconfig.json</code>  文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;extends&quot;: &#123;</span><br><span class="line">      &quot;compilerOptions&quot;: &#123;</span><br><span class="line">        &quot;baseUrl&quot;: &quot;./&quot;,</span><br><span class="line">        &quot;paths&quot;: &#123;</span><br><span class="line">          &quot;@/*&quot;: [&quot;src/*&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="移动端适配"><a href="#移动端适配" class="headerlink" title="移动端适配"></a>移动端适配</h2><p>使用 <code>postcss-px-to-viewport</code> 包将 px 转换成 vw</p>
<p><strong>步骤如下</strong></p>
<ol>
<li>下包：使用 <code>postcss-px-to-viewport</code>包会出现版本不匹配错误，使用如下包解决</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add postcss-px-to-viewport-8-plugin</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 <code>croco.config.js</code>文件中配置</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line"><span class="comment">// ... 省略其他配置</span></span><br><span class="line"><span class="attr">style</span>: &#123;</span><br><span class="line">    <span class="attr">postcss</span>: &#123;</span><br><span class="line">      <span class="comment">//   plugins: [vw]</span></span><br><span class="line">			<span class="attr">mode</span>: <span class="string">&#x27;extends&#x27;</span>,</span><br><span class="line">			<span class="attr">loaderOptions</span>: &#123;</span><br><span class="line">				<span class="attr">postcssOptions</span>: &#123;</span><br><span class="line">					<span class="attr">ident</span>: <span class="string">&#x27;postcss&#x27;</span>,</span><br><span class="line">					<span class="attr">plugins</span>: [</span><br><span class="line">						[</span><br><span class="line">							<span class="string">&#x27;postcss-px-to-viewport-8-plugin&#x27;</span>,</span><br><span class="line">							&#123;</span><br><span class="line">								<span class="attr">viewportWidth</span>: <span class="number">375</span>, <span class="comment">// 设计稿的视口宽度</span></span><br><span class="line">							&#125;,</span><br><span class="line">						],</span><br><span class="line">					],</span><br><span class="line">				&#125;,</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="移动端-1px-像素处理"><a href="#移动端-1px-像素处理" class="headerlink" title="移动端 1px 像素处理"></a>移动端 1px 像素处理</h2><p>css 的 1px 在 PC 端就是 1px， 在移动端就往往就 &gt;1px 了，会使得线条过大</p>
<h3 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h3><ul>
<li>设备像素比：dpr&#x3D;window.devicePixelRatio，也就是设备的物理像素与逻辑像素的比值。</li>
<li>在<code>retina</code>屏的手机上, <code>dpr</code>为<code>2</code>或<code>3</code>，<code>css</code>里写的<code>1px</code>宽度映射到物理像素上就有<code>2px</code>或<code>3px</code>宽度。</li>
<li>例如：<code>iPhone6</code>的<code>dpr</code>为<code>2</code>，物理像素是<code>750</code>（x轴）,它的逻辑像素为<code>375</code>。也就是说，1个逻辑像素，在<code>x</code>轴和<code>y</code>轴方向，需要2个物理像素来显示，即：dpr&#x3D;2时，表示1个CSS像素由4个物理像素点组成。</li>
</ul>
<h3 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a><strong>解决方式</strong></h3><h4 id="1-伪元素-transform-缩放"><a href="#1-伪元素-transform-缩放" class="headerlink" title="1. 伪元素 + transform 缩放"></a><strong>1. 伪元素 + transform 缩放</strong></h4><blockquote>
<p>伪元素<code>::after</code>或<code>::before</code>独立于当前元素，可以单独对其缩放而不影响元素本身的缩放</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/xgangzai/article/details/107118168">https://blog.csdn.net/xgangzai/article/details/107118168</a></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;author&quot;</span> <span class="attr">content</span>=<span class="string">&quot;helang.love@qq.com&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>移动端 1px(线条/边框) 解决方案<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: <span class="string">&#x27;Microsoft YaHei&#x27;</span>, <span class="string">&#x27;Times New Roman&#x27;</span>, Times, serif;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"> </span></span><br><span class="line"><span class="language-css">        <span class="comment">/* 线条 */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.list</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.list</span>&gt;<span class="selector-tag">li</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.list</span>&gt;<span class="selector-tag">li</span><span class="selector-pseudo">:not</span>(<span class="selector-pseudo">:first</span>-child)<span class="selector-pseudo">:after</span>&#123;   <span class="comment">/* CSS匹配非第一个直接子元素 */</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-top</span>: <span class="number">#999</span> solid <span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(<span class="number">0.5</span>); <span class="comment">/* 将 1px 的线条缩小为原来的 50% */</span></span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"> </span></span><br><span class="line"><span class="language-css">        <span class="comment">/* 边框 */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.button</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: <span class="number">#f8f8f8</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.button</span><span class="selector-pseudo">:after</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>: -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">bottom</span>: -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: -<span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">50%</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">8px</span>; <span class="comment">/* 尺寸缩小 50%，即圆角半径设置为按钮的2倍 */</span></span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>线条 1px<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>边框 1px<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="sass-自定义函数"><a href="#sass-自定义函数" class="headerlink" title="sass 自定义函数"></a>sass 自定义函数</h2><p>sass 中 @mixin 指令允许我们定义一个可以在整个样式表中重复使用的样式。</p>
<p>@include 指令可以将混入（mixin）引入到文档中。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ant-design/ant-design-mobile/blob/v2/components/style/mixins/hairline.less">实现参考 antd-mobile</a></p>
<ul>
<li>定义解决 1px 函数创建公共样式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">// src/assets/styles/hairline.scss</span><br><span class="line"></span><br><span class="line">@mixin scale-hairline-common($color, $top, $right, $bottom, $left) &#123;</span><br><span class="line">  content: &#x27;&#x27;;</span><br><span class="line">  position: absolute;</span><br><span class="line">  display: block;</span><br><span class="line">  z-index: 1;</span><br><span class="line">  top: $top;</span><br><span class="line">  right: $right;</span><br><span class="line">  bottom: $bottom;</span><br><span class="line">  left: $left;</span><br><span class="line">  background-color: $color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@mixin hairline($direction, $color: #000, $radius: 0) &#123;</span><br><span class="line">  @if $direction == top &#123;</span><br><span class="line">    border-top: 1px solid $color;</span><br><span class="line"></span><br><span class="line">    // min-resolution 用来检测设备的最小像素密度</span><br><span class="line">    @media (min-resolution: 2dppx) &#123;</span><br><span class="line">      border-top: none;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        @include scale-hairline-common($color, 0, auto, auto, 0);</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 1px;</span><br><span class="line">        transform-origin: 50% 50%;</span><br><span class="line">        transform: scaleY(0.5);</span><br><span class="line"></span><br><span class="line">        @media (min-resolution: 3dppx) &#123;</span><br><span class="line">          transform: scaleY(0.33);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $direction == right &#123;</span><br><span class="line">    border-right: 1px solid $color;</span><br><span class="line"></span><br><span class="line">    @media (min-resolution: 2dppx) &#123;</span><br><span class="line">      border-right: none;</span><br><span class="line"></span><br><span class="line">      &amp;::after &#123;</span><br><span class="line">        @include scale-hairline-common($color, 0, 0, auto, auto);</span><br><span class="line">        width: 1px;</span><br><span class="line">        height: 100%;</span><br><span class="line">        background: $color;</span><br><span class="line">        transform-origin: 100% 50%;</span><br><span class="line">        transform: scaleX(0.5);</span><br><span class="line"></span><br><span class="line">        @media (min-resolution: 3dppx) &#123;</span><br><span class="line">          transform: scaleX(0.33);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $direction == bottom &#123;</span><br><span class="line">    border-bottom: 1px solid $color;</span><br><span class="line"></span><br><span class="line">    @media (min-resolution: 2dppx) &#123;</span><br><span class="line">      border-bottom: none;</span><br><span class="line"></span><br><span class="line">      &amp;::after &#123;</span><br><span class="line">        @include scale-hairline-common($color, auto, auto, 0, 0);</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 1px;</span><br><span class="line">        transform-origin: 50% 100%;</span><br><span class="line">        transform: scaleY(0.5);</span><br><span class="line"></span><br><span class="line">        @media (min-resolution: 3dppx) &#123;</span><br><span class="line">          transform: scaleY(0.33);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $direction == left &#123;</span><br><span class="line">    border-left: 1px solid $color;</span><br><span class="line"></span><br><span class="line">    @media (min-resolution: 2dppx) &#123;</span><br><span class="line">      border-left: none;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        @include scale-hairline-common($color, 0, auto, auto, 0);</span><br><span class="line">        width: 1px;</span><br><span class="line">        height: 100%;</span><br><span class="line">        transform-origin: 100% 50%;</span><br><span class="line">        transform: scaleX(0.5);</span><br><span class="line"></span><br><span class="line">        @media (min-resolution: 3dppx) &#123;</span><br><span class="line">          transform: scaleX(0.33);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $direction == all &#123;</span><br><span class="line">    border: 1px solid $color;</span><br><span class="line">    border-radius: $radius;</span><br><span class="line"></span><br><span class="line">    @media (min-resolution: 2dppx) &#123;</span><br><span class="line">      position: relative;</span><br><span class="line">      border: none;</span><br><span class="line"></span><br><span class="line">      &amp;::before &#123;</span><br><span class="line">        content: &#x27;&#x27;;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 0;</span><br><span class="line">        top: 0;</span><br><span class="line">        width: 200%;</span><br><span class="line">        height: 200%;</span><br><span class="line">        border: 1px solid $color;</span><br><span class="line">        border-radius: $radius * 2;</span><br><span class="line">        transform-origin: 0 0;</span><br><span class="line">        transform: scale(0.5);</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line">        pointer-events: none;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 移除边框</span><br><span class="line">@mixin hairline-remove($position: all) &#123;</span><br><span class="line">  @if $position == left &#123;</span><br><span class="line">    border-left: 0;</span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $position == right &#123;</span><br><span class="line">    border-right: 0;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $position == top &#123;</span><br><span class="line">    border-top: 0;</span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $position == bottom &#123;</span><br><span class="line">    border-bottom: 0;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; @else if $position == all &#123;</span><br><span class="line">    border: 0;</span><br><span class="line">    &amp;::before &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在某个 scss 文件中使用</li>
</ul>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入该文件后调用</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~@scss/hairline.scss&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>:relative;</span><br><span class="line">  <span class="keyword">@include</span> hairline(bottom, <span class="number">#000</span>); <span class="comment">// 添加边框</span></span><br><span class="line">  <span class="keyword">@include</span> hairline-remove(bottom); <span class="comment">// 移除边框</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="icon-彩色图标"><a href="#icon-彩色图标" class="headerlink" title="icon 彩色图标"></a>icon 彩色图标</h2><p><a target="_blank" rel="noopener" href="https://www.iconfont.cn/help/detail?spm=a313x.7781069.1998910419.d8cf4382a&helptype=code">彩色图标文档</a></p>
<p><strong>使用步骤</strong></p>
<ol>
<li>在 public 下 index.html 中引入生成的 js 链接</li>
<li>在 <code>index.scss</code> 中添加通过 css 代码</li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">  fill: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在组件中，使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg className=<span class="string">&quot;icon&quot;</span> aria-hidden=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">  &#123;<span class="comment">/* 使用时，只需要将此处的 iconbtn_like_sel 替换为 icon 的名称即可*/</span>&#125;</span><br><span class="line">  &lt;use xlinkHref=<span class="string">&quot;#iconbtn_like_sel&quot;</span>&gt;&lt;/use&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">className</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  &#123;/* 使用时，只需要将此处的 iconbtn_like_sel 替换为 icon 的名称即可*/&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlinkHref</span>=<span class="string">&quot;#xxxxxxxx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>项目中会封装 Icon 组件</p>
<h2 id="TS-类型文件"><a href="#TS-类型文件" class="headerlink" title="TS 类型文件"></a>TS 类型文件</h2><p>在使用 TS 开发与接口相关功能时，推荐按照以下步骤：</p>
<ol>
<li>准备数据类型。先按照接口的返回数据，准备 TS 类型</li>
<li>指定该请求的返回值类型。在发送请求时，指定该请求的返回值类型</li>
</ol>
<p>这样，在接下来的操作中，有两个好处：</p>
<ol>
<li>有类型提示。如果需要用到接口的数据，都会有类型提示了。</li>
<li>有利于项目代码的重构和修改。如果将来后端接口返回的数据变了，只需要修改对应的 TS 类型，然后，所有用到该类型的地方如果有问题，都会自动提示出来。</li>
</ol>
<p>在 types 目录下新建 <code>data.d.ts</code> 类型说明文件，新建 <code>store.d.ts</code> 集中放置 store 类型文件</p>
<h2 id="路由鉴权"><a href="#路由鉴权" class="headerlink" title="路由鉴权"></a>路由鉴权</h2><p>react 中没有路由守卫，但是类似的功能有现成的。<a target="_blank" rel="noopener" href="https://v5.reactrouter.com/web/example/auth-workflow">参考官网</a></p>
<p>项目中定义私有路由组件来实现路由的访问登录控制 </p>
<h2 id="401报错"><a href="#401报错" class="headerlink" title="401报错"></a>401报错</h2><p>有如下两种情况会出现401错误：</p>
<ol>
<li>未登陆用户做一些需要权限才能做的操作（例如：关注作者），代码会报出401错误。这种情况下，应该让用户回到登陆页。</li>
<li>登录用户的 token 过期了</li>
</ol>
<p>通常通过 axio s响应拦截器来处理401问题。</p>
<h2 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h2><p>WebSocket 是一种数据通信<strong>协议</strong>，类似于我们常见的 http 协议。</p>
<p>HTTP 协议单向请求的特点，注定了如果服务器有连续的状态变化，客户端要获知就非常麻烦。我们只能使用<a target="_blank" rel="noopener" href="https://www.pubnub.com/blog/2014-12-01-http-long-polling/">“轮询”</a>：每隔一段时候，就发出一个询问，了解服务器有没有新的信息。最典型的场景就是聊天室。</p>
<p>轮询的效率低，非常浪费资源（因为必须不停连接，或者 HTTP 连接始终打开）。因此，工程师们一直在思考，有没有更好的方法。WebSocket 就是这样发明的。</p>
<p><strong>简介</strong></p>
<p>该协议在2008年诞生，2011年成为国际标准。所有浏览器都已经支持了。</p>
<p>其最大特点就是，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，是真正的双向平等对话，属于<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Push_technology">服务器推送技术</a>的一种。</p>
<p>典型的 websocket 应用场景：</p>
<ul>
<li>即时通讯…..客服  </li>
<li>聊天室 广播</li>
<li>点餐</li>
</ul>
<h3 id="socket-技术"><a href="#socket-技术" class="headerlink" title="socket 技术"></a>socket 技术</h3><ol>
<li><strong>客户端</strong>：发 socket 请求<ol>
<li>可以用原生的</li>
<li>可以使用包 <strong>socket.io</strong></li>
</ol>
</li>
<li>服务器端: 提供 socket 服务<ol>
<li><strong>socket.io</strong></li>
</ol>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://socketio-chat-h9jt.herokuapp.com/">测试案例</a></p>
<h3 id="socket-io"><a href="#socket-io" class="headerlink" title="socket.io"></a>socket.io</h3><p>下包：<code>npm i socket.io-client</code>，该包专门在客户端使用</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io <span class="keyword">from</span> <span class="string">&#x27;socket.io-client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 和服务器建立了链接</span></span><br><span class="line"><span class="keyword">const</span> client = <span class="title function_">io</span>(<span class="string">&#x27;地址&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">query</span>: &#123;</span><br><span class="line">        <span class="attr">token</span>: 用户token</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">transports</span>: [<span class="string">&#x27;websocket&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// connect， disconnect 是固定的名字</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;connect&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)  <span class="comment">// 当和服务器建立连接成功，这个事件就会触发</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;disconnect&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)    <span class="comment">// 和服务器断开链接，就会触发disconnect</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// message是事件名，这个可以由后端去修改</span></span><br><span class="line">client.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;)  <span class="comment">// 接收到服务器的消息，这个事件就会触发</span></span><br><span class="line"><span class="comment">// 主动给服务器发送消息</span></span><br><span class="line">client.<span class="title function_">emit</span>(<span class="string">&#x27;message&#x27;</span>, 值)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 主动关闭和服务器的链接</span></span><br><span class="line">client.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>

<p>在 react 中借助于 <code>useEffect</code>，在进入页面时调用客户端库建立 socket.io 连接</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于缓存 socket.io 客户端实例</span></span><br><span class="line"><span class="keyword">const</span> clientRef = useRef&lt;<span class="title class_">Socket</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 创建客户端实例</span></span><br><span class="line">  <span class="keyword">const</span> client = <span class="title function_">io</span>(<span class="string">&#x27;http://toutiao.itheima.net&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">transports</span>: [<span class="string">&#x27;websocket&#x27;</span>],</span><br><span class="line">    <span class="comment">// 在查询字符串参数中传递 token</span></span><br><span class="line">    <span class="attr">query</span>: &#123;</span><br><span class="line">      <span class="attr">token</span>: <span class="title function_">getToken</span>().<span class="property">token</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听连接成功的事件</span></span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&#x27;connect&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 向聊天记录中添加一条消息</span></span><br><span class="line">    <span class="title function_">setMessageList</span>(<span class="function"><span class="params">messageList</span> =&gt;</span> [</span><br><span class="line">      ...messageList,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;robot&#x27;</span>, <span class="attr">text</span>: <span class="string">&#x27;我现在恭候着您的提问。&#x27;</span> &#125;</span><br><span class="line">    ])</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听收到消息的事件</span></span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&gt;&gt;&gt;&gt;收到 socket.io 消息:&#x27;</span>, data)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将客户端实例缓存到 ref 引用中</span></span><br><span class="line">  clientRef.<span class="property">current</span> = client</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在组件销毁时关闭 socket.io 的连接</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    client.<span class="title function_">close</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure>



<h2 id="lodash"><a href="#lodash" class="headerlink" title="lodash"></a>lodash</h2><h4 id="differenceBy"><a href="#differenceBy" class="headerlink" title="differenceBy()"></a>differenceBy()</h4><p>该方法可以用来过滤数据，其接收三个参数，分别是要检查的数组、排除的值、调用的每个元素，返回一个过滤值后的新数组。</p>
<p><a target="_blank" rel="noopener" href="https://www.lodashjs.com/docs/lodash.differenceBy">见中文文档</a></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; differenceBy &#125; <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> optionChannel = <span class="title function_">useSelector</span>(<span class="function">(<span class="params">state: RootState</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 推荐频道 = 所有频道 - 我的频道</span></span><br><span class="line">  <span class="keyword">const</span> &#123; userChannel, allChannel &#125; = state.<span class="property">home</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">differenceBy</span>(allChannel, userChannel, <span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="debounce"><a href="#debounce" class="headerlink" title="debounce()"></a>debounce()</h3><p><a target="_blank" rel="noopener" href="https://www.lodashjs.com/docs/lodash.debounce">见中文文档</a></p>
<p>该方法创建一个防抖函数，函数会从上一次被调用后，延迟 <code>wait</code> 毫秒后调用 <code>func</code> 方法</p>
<p><code>_.debounce(func, [wait=0], [options=])</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当点击时 `sendMail` 随后就被调用。</span></span><br><span class="line"><span class="title function_">jQuery</span>(element).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, _.<span class="title function_">debounce</span>(sendMail, <span class="number">300</span>, &#123;</span><br><span class="line">  <span class="string">&#x27;leading&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;trailing&#x27;</span>: <span class="literal">false</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>





<h2 id="dayjs"><a href="#dayjs" class="headerlink" title="dayjs"></a>dayjs</h2><p><a target="_blank" rel="noopener" href="https://dayjs.gitee.io/docs/zh-CN/plugin/relative-time">相对时间处理</a></p>
<p>相对时间处理指将标准时间转换成相对时间。<code>2022-10-07</code> -&gt; <code>1天前</code></p>
<p><strong>步骤</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line"><span class="keyword">import</span> relativeTime <span class="keyword">from</span> <span class="string">&#x27;dayjs/plugin/relativeTime&#x27;</span></span><br><span class="line">dayjs.<span class="title function_">extend</span>(relativeTime)</span><br><span class="line"><span class="comment">// 国际化</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;dayjs/locale/zh-cn&#x27;</span></span><br><span class="line">dayjs.<span class="title function_">locale</span>(<span class="string">&#x27;zh-cn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="title function_">dayjs</span>(<span class="string">&#x27;2021-12-06&#x27;</span>).<span class="title function_">fromNow</span>() )</span><br></pre></td></tr></table></figure>



<h2 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h2><h3 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h3><p>当 dom元素进入可视区域时，才去加载它。</p>
<p>如何判断一个 dom 元素是否进入了可见区域？</p>
<ul>
<li>传统： <a href="https://gitee.com/link?target=https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect">获取dom的位置</a>，手动判断。（距离页面顶部的距离 比较 滚动条卷起的高度，还要考虑元素自己的高度 ）</li>
<li>现在：<a href="https://gitee.com/link?target=https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver">直接判断元素进入可视区域的比例</a></li>
</ul>
<h3 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h3><p>利用浏览器提供的 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver/IntersectionObserver">IntersectionObserver</a>，监听图片元素是否进入可视区域，进入后才真正去设置图片元素的 <code>src</code> 属性进行图片加载。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> dom = dom元素</span><br><span class="line"><span class="comment">// 实例化一个观察者</span></span><br><span class="line"><span class="comment">// 它的参数1是一个回调：当被观察的目标进入视口/离开视口就会调用</span></span><br><span class="line"><span class="keyword">var</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function">(<span class="params">entries</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// 当观察者元素可见时 isIntersecting 为 true</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(entries[<span class="number">0</span>].<span class="property">isIntersecting</span>)</span><br><span class="line">  <span class="keyword">if</span>(entries[<span class="number">0</span>].<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">    <span class="comment">// 可见时给图片 src 赋值</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, 其他配置)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 观察者观察 dom</span></span><br><span class="line">observer.<span class="title function_">observe</span>(dom)</span><br><span class="line">observer.<span class="title function_">disconnect</span>()   <span class="comment">// 停止观察者</span></span><br><span class="line">observer.<span class="title function_">unobserve</span>(dom) <span class="comment">// 观察者停止对 dom 的观察</span></span><br><span class="line"><span class="comment">// 可以观察多个 dom 元素，参见 https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/observe</span></span><br><span class="line"><span class="keyword">const</span> boxElList = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.box&#x27;</span>);</span><br><span class="line">boxElList.<span class="title function_">forEach</span>(<span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">  observer.<span class="title function_">observe</span>(el);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>项目中可以封装懒加载的组件</p>
<h2 id="classnames"><a href="#classnames" class="headerlink" title="classnames"></a>classnames</h2><ul>
<li>该包用于有条件地将类名连接在一起。该函数接受任意数量的参数，可以是字符串或对象</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下包： yarn add classnames</span></span><br><span class="line"><span class="keyword">import</span> classnames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">classNames</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>); <span class="comment">// =&gt; &#x27;foo bar&#x27;</span></span><br><span class="line"><span class="title function_">classNames</span>(<span class="string">&#x27;foo&#x27;</span>, &#123; <span class="attr">bar</span>: <span class="literal">true</span> &#125;); <span class="comment">// =&gt; &#x27;foo bar&#x27;</span></span><br><span class="line"><span class="title function_">classNames</span>(&#123; <span class="string">&#x27;foo-bar&#x27;</span>: <span class="literal">true</span> &#125;); <span class="comment">// =&gt; &#x27;foo-bar&#x27;</span></span><br><span class="line"><span class="title function_">classNames</span>(&#123; <span class="string">&#x27;foo-bar&#x27;</span>: <span class="literal">false</span> &#125;); <span class="comment">// =&gt; &#x27;&#x27;</span></span><br><span class="line"><span class="title function_">classNames</span>(&#123; <span class="attr">foo</span>: <span class="literal">true</span> &#125;, &#123; <span class="attr">bar</span>: <span class="literal">true</span> &#125;); <span class="comment">// =&gt; &#x27;foo bar&#x27;</span></span><br><span class="line"><span class="title function_">classNames</span>(&#123; <span class="attr">foo</span>: <span class="literal">true</span>, <span class="attr">bar</span>: <span class="literal">true</span> &#125;); <span class="comment">// =&gt; &#x27;foo bar&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// lots of arguments of various types</span></span><br><span class="line"><span class="title function_">classNames</span>(<span class="string">&#x27;foo&#x27;</span>, &#123; <span class="attr">bar</span>: <span class="literal">true</span>, <span class="attr">duck</span>: <span class="literal">false</span> &#125;, <span class="string">&#x27;baz&#x27;</span>, &#123; <span class="attr">quux</span>: <span class="literal">true</span> &#125;); <span class="comment">// =&gt; &#x27;foo bar baz quux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// other falsy values are just ignored</span></span><br><span class="line"><span class="title function_">classNames</span>(<span class="literal">null</span>, <span class="literal">false</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="literal">undefined</span>, <span class="number">0</span>, <span class="number">1</span>, &#123; <span class="attr">baz</span>: <span class="literal">null</span> &#125;, <span class="string">&#x27;&#x27;</span>); <span class="comment">// =&gt; &#x27;bar 1&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="防抖处理"><a href="#防抖处理" class="headerlink" title="防抖处理"></a>防抖处理</h2><p>在使用搜索功能时会需要用到防抖，可以自己写防抖，也可以使用第三方库</p>
<p><strong>实现</strong></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存储防抖定时器</span></span><br><span class="line"><span class="keyword">const</span> timerRef = <span class="title function_">useRef</span>(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [keyword, setKeyword] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onChange</span> = (<span class="params">e: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">setKeyword</span>(e)</span><br><span class="line">  <span class="comment">// 清除之前的定时器</span></span><br><span class="line">  <span class="built_in">clearTimeout</span>(timerRef.<span class="property">current</span>)</span><br><span class="line">  <span class="comment">// 新建任务定时器</span></span><br><span class="line">  timerRef.<span class="property">current</span> = <span class="variable language_">window</span>.<span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e)</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 销毁组件时记得最好要清理定时器</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timerRef.<span class="property">current</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [])</span><br></pre></td></tr></table></figure>

<p>第三方库如 aHooks(useDebounceFn)、lodash(_.debounce)</p>
<h2 id="aHooks"><a href="#aHooks" class="headerlink" title="aHooks"></a>aHooks</h2><blockquote>
<p>ahooks，是一套高质量可靠的 React Hooks 库。在 React 项目研发过程中，一套好用的 React Hooks 库是必不可少的。</p>
</blockquote>
<h3 id="useDebounceFn"><a href="#useDebounceFn" class="headerlink" title="useDebounceFn"></a>useDebounceFn</h3><p>用来处理防抖函数的 Hook。<a target="_blank" rel="noopener" href="https://ahooks-next.surge.sh/zh-CN/hooks/use-debounce-fn">官网文档</a></p>
<p>频繁调用 run，但只会在所有点击完成 500ms 后执行一次相关函数</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useDebounceFn &#125; <span class="keyword">from</span> <span class="string">&#x27;ahooks&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; run &#125; = <span class="title function_">useDebounceFn</span>(</span><br><span class="line">	<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;搜索功能&#x27;</span>, e)</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123; <span class="attr">wait</span>: <span class="number">500</span> &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>





<h2 id="高亮关键字处理"><a href="#高亮关键字处理" class="headerlink" title="高亮关键字处理"></a>高亮关键字处理</h2><p>![img](C:&#x2F;Users&#x2F;矿机&#x2F;Desktop&#x2F;Blog&#x2F;source&#x2F;img&#x2F;React 移动端总结&#x2F;image-20211206185240350.png)</p>
<p>一般而言封装一个高亮函数。在目标字符串中，用正则做匹配，如果匹配到，就用参数2的返回值来替代匹配的部分。<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace">官方文档</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const 新字符串 = 目标字符串.replace(正则表达式，function(匹配结果) &#123;</span></span><br><span class="line"><span class="comment">//             return 对匹配到的内容的替换结果</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">highLight</span> = (<span class="params">str: string， keyword: string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">replace</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">RegExp</span>(keyword, <span class="string">&#x27;gi&#x27;</span>),</span><br><span class="line">    <span class="function">(<span class="params">match</span>) =&gt;</span> <span class="string">`&lt;span&gt;<span class="subst">$&#123;match&#125;</span>&lt;/span&gt;`</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="innerHTML"><a href="#innerHTML" class="headerlink" title="innerHTML"></a>innerHTML</h2><p>在 react 中，官方推出了 <code>dangerouslySetInnerHTML</code> 属性，<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml">详见官网</a></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&#123;<span class="string">&#x27;&lt;h1&gt;abc&lt;/h1&gt;&#x27;</span>&#125;&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;</span> <span class="attr">__html:</span> &#x27;&lt;<span class="attr">h1</span>&gt;</span>abc<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#x27; &#125;&#125; /&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="防-XSS-攻击"><a href="#防-XSS-攻击" class="headerlink" title="防 XSS 攻击"></a>防 XSS 攻击</h2><p>当渲染 code 标签时，可以通过 <code>highlight.js</code> 包来实现代码块高亮。例子如下</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下包：yarn add highlight.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hljs <span class="keyword">from</span> <span class="string">&#x27;highlight.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;highlight.js/styles/vs2015.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Question</span> () &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 配置 highlight.js</span></span><br><span class="line">    hljs.<span class="title function_">configure</span>(&#123;</span><br><span class="line">      <span class="comment">// 忽略未经转义的 HTML 字符</span></span><br><span class="line">      <span class="attr">ignoreUnescapedHTML</span>: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 获取到内容中所有的code标签</span></span><br><span class="line">    <span class="keyword">const</span> codes = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.dg-html pre code&#x27;</span>)</span><br><span class="line">    codes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 让code进行高亮</span></span><br><span class="line">      hljs.<span class="title function_">highlightElement</span>(el <span class="keyword">as</span> <span class="title class_">HTMLElement</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">const</span> content = <span class="string">`&lt;pre&gt;</span></span><br><span class="line"><span class="string"> 	 &lt;code&gt;console.log(abc)&lt;/code&gt;</span></span><br><span class="line"><span class="string">  	&lt;code&gt;console.log(abc)&lt;/code&gt;</span></span><br><span class="line"><span class="string">    &lt;/pre&gt;</span></span><br><span class="line"><span class="string">    &lt;h3&gt;nihoa&lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;pre&gt;</span></span><br><span class="line"><span class="string">      &lt;code&gt;console.log(abc);xxx.forEach(item=&gt;&#123;console.log(1)&#125;)&lt;/code&gt;</span></span><br><span class="line"><span class="string">    &lt;/pre&gt;`</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;dg-html&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      Question</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;</span> <span class="attr">__html:</span> <span class="attr">content</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但是该包不能避免 XSS 攻击。使用 <code>dompurify</code> 可对 HTML 内容进行净化处理</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下包：	yarn add dompurify @types/dompurify -D</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DOMPurify</span> <span class="keyword">from</span> <span class="string">&#x27;dompurify&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;div</span><br><span class="line">  className=<span class="string">&quot;content-html dg-html&quot;</span></span><br><span class="line">  dangerouslySetInnerHTML=&#123;&#123; <span class="attr">__html</span>: <span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(info.<span class="property">content</span> || <span class="string">&#x27;&#x27;</span>) &#125;&#125;</span><br><span class="line">  &gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>



<h2 id="keep-alive-功能"><a href="#keep-alive-功能" class="headerlink" title="keep-alive 功能"></a>keep-alive 功能</h2><p>react 中路由没有自带缓存功能，每次路由切换页面组件都会销毁。</p>
<p>通过封装自定义路由来实现缓存效果。</p>
<p><strong>原理</strong>：切换路由时让页面不卸载，而是通过 display none 隐藏掉。因为页面没有卸载，所以原来所有的操作都会被保存下来。 将来再返回该页面，只需要 display block 展示即可。这样，就可以恢复原来的内容达到缓存的目的。</p>
<h3 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h3><ol>
<li>Switch 之外的 Route 中如果设置了 children 属性，且值是函数，此时，这个函数一定会执行；</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/any-path&quot;</span> children=&#123;<span class="function">()=&gt;</span><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>child<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;&gt;&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Switch 之内的 Route 中如果设置了 children 属性，且值是函数，此时，它的 path 匹配优先级是最低的。</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable react/no-children-prop */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span>, <span class="title class_">RouteChildrenProps</span>, <span class="title class_">RouteProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = <span class="title class_">RouteProps</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">KeepAlive</span> (&#123; path, children, ...rest &#125;: <span class="title class_">Props</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">child</span> = (<span class="params">props: RouteChildrenProps</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child....&#x27;</span>, props)</span><br><span class="line">    <span class="comment">// const isMatch = props.location.pathname.startsWith(path as string)</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;keep-alive&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> <span class="attr">props.match</span> ? &#x27;<span class="attr">block</span>&#x27; <span class="attr">:</span> &#x27;<span class="attr">none</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;path&#125;</span> &#123;<span class="attr">...rest</span>&#125; <span class="attr">children</span>=<span class="string">&#123;child&#125;</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要缓存的页面直接使用即可</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">KeepAlive</span> path=<span class="string">&quot;/home&quot;</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">KeepAlive</span>&gt;</span><br></pre></td></tr></table></figure>



<h2 id="Diff-算法说明"><a href="#Diff-算法说明" class="headerlink" title="Diff 算法说明"></a>Diff 算法说明</h2><ul>
<li>如果两棵树的<strong>根元素类型</strong>不同，React 会销毁旧树，创建新树</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧树</span></span><br><span class="line">&lt;div&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新树</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">执行过程：destory <span class="title class_">Counter</span> -&gt; insert <span class="title class_">Counter</span></span><br></pre></td></tr></table></figure>

<ul>
<li>对于类型相同的 React DOM 元素，React 会对比两者的属性是否相同，只更新不同的属性</li>
<li>当处理完这个 DOM 节点，React 就会递归处理子节点</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧</span></span><br><span class="line">&lt;div className=<span class="string">&quot;before&quot;</span> title=<span class="string">&quot;stuff&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="comment">// 新</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;after&quot;</span> <span class="attr">title</span>=<span class="string">&quot;stuff&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">只更新：className 属性</span><br><span class="line"></span><br><span class="line"><span class="comment">// 旧</span></span><br><span class="line">&lt;div style=&#123;&#123;<span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>, <span class="attr">fontWeight</span>: <span class="string">&#x27;bold&#x27;</span>&#125;&#125;&gt;&lt;/div&gt;</span><br><span class="line"><span class="comment">// 新</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">green</span>&#x27;, <span class="attr">fontWeight:</span> &#x27;<span class="attr">bold</span>&#x27;&#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">只更新：color属性</span><br></pre></td></tr></table></figure>

<ul>
<li>当在子节点的后面添加一个节点，这时候转化工作执行的很好</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>first<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>second<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>third<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">执行过程：</span><br><span class="line"><span class="title class_">React</span>会匹配新旧两个&lt;li&gt;first&lt;<span class="regexp">/li&gt;，匹配两个&lt;li&gt;second&lt;/</span>li&gt;，然后添加 &lt;li&gt;third&lt;/li&gt; tree</span><br></pre></td></tr></table></figure>

<p>但是如果在开始位置插入一个元素，那么问题就来了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">执行过程：</span><br><span class="line"><span class="title class_">React</span>将改变每一个子节点，而非保持 &lt;li&gt;<span class="title class_">Duke</span>&lt;<span class="regexp">/li&gt; 和 &lt;li&gt;Villanova&lt;/</span>li&gt; 不变</span><br></pre></td></tr></table></figure>

<h3 id="key-属性"><a href="#key-属性" class="headerlink" title="key 属性"></a>key 属性</h3><p>为了解决以上问题，React 提供了一个 key 属性。当子节点带有 key 属性，React 会通过 key 来匹配原始树和后来的树。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&quot;2015&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&quot;2016&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&quot;2014&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&quot;2015&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&quot;2016&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">执行过程：</span><br><span class="line">现在 <span class="title class_">React</span> 知道带有key <span class="string">&#x27;2014&#x27;</span> 的元素是新的，对于 <span class="string">&#x27;2015&#x27;</span> 和 <span class="string">&#x27;2016&#x27;</span> 仅仅移动位置即可</span><br></pre></td></tr></table></figure>

<ul>
<li>说明：key 属性在 React 内部使用，但不会传递给你的组件</li>
<li>推荐：在遍历数据时，推荐在组件中使用 key 属性：<code>&lt;li key=&#123;item.id&#125;&gt;&#123;item.name&#125;&lt;/li&gt;</code></li>
<li>注意：<strong>key 只需要保持与他的兄弟节点唯一即可，不需要全局唯一</strong></li>
<li>注意：<strong>尽可能的减少数组 index 作为 key，数组中插入元素的等操作时，会使得效率低下</strong></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://metabo6.github.io">随时奉陪</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://metabo6.github.io/posts/cd25c3da.html">https://metabo6.github.io/posts/cd25c3da.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://metabo6.github.io" target="_blank">随时奉陪</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/React-%E7%A7%BB%E5%8A%A8%E7%AB%AF/">React 移动端</a></div><div class="post_share"><div class="social-share" data-image="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/react.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/4f68be61.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/react.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">React 总结</div></div></a></div><div class="next-post pull-right"><a href="/posts/206a9599.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/react.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">React 项目总结</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly/index.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">随时奉陪</div><div class="author-info__description">向往自由，追求自由，找寻自由</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/metabo6"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#React-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93"><span class="toc-number">1.</span> <span class="toc-text">React 移动端总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#antd-mobile"><span class="toc-number">1.1.</span> <span class="toc-text">antd-mobile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#antd-mobile%E4%B8%BB%E9%A2%98%E5%AE%9A%E5%88%B6"><span class="toc-number">1.1.1.</span> <span class="toc-text">antd-mobile主题定制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSS-%E5%8F%98%E9%87%8F"><span class="toc-number">1.2.</span> <span class="toc-text">CSS 变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#craco"><span class="toc-number">1.3.</span> <span class="toc-text">craco</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tsconfig-json"><span class="toc-number">1.4.</span> <span class="toc-text">tsconfig.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D"><span class="toc-number">1.5.</span> <span class="toc-text">移动端适配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF-1px-%E5%83%8F%E7%B4%A0%E5%A4%84%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">移动端 1px 像素处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0"><span class="toc-number">1.6.1.</span> <span class="toc-text">产生原因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F"><span class="toc-number">1.6.2.</span> <span class="toc-text">解决方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BC%AA%E5%85%83%E7%B4%A0-transform-%E7%BC%A9%E6%94%BE"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">1. 伪元素 + transform 缩放</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sass-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">sass 自定义函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icon-%E5%BD%A9%E8%89%B2%E5%9B%BE%E6%A0%87"><span class="toc-number">1.8.</span> <span class="toc-text">icon 彩色图标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TS-%E7%B1%BB%E5%9E%8B%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.</span> <span class="toc-text">TS 类型文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%89%B4%E6%9D%83"><span class="toc-number">1.10.</span> <span class="toc-text">路由鉴权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#401%E6%8A%A5%E9%94%99"><span class="toc-number">1.11.</span> <span class="toc-text">401报错</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#websocket"><span class="toc-number">1.12.</span> <span class="toc-text">websocket</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#socket-%E6%8A%80%E6%9C%AF"><span class="toc-number">1.12.1.</span> <span class="toc-text">socket 技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#socket-io"><span class="toc-number">1.12.2.</span> <span class="toc-text">socket.io</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lodash"><span class="toc-number">1.13.</span> <span class="toc-text">lodash</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#differenceBy"><span class="toc-number">1.13.0.1.</span> <span class="toc-text">differenceBy()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debounce"><span class="toc-number">1.13.1.</span> <span class="toc-text">debounce()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dayjs"><span class="toc-number">1.14.</span> <span class="toc-text">dayjs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.15.</span> <span class="toc-text">图片懒加载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">1.15.1.</span> <span class="toc-text">基本思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"><span class="toc-number">1.15.2.</span> <span class="toc-text">实现思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#classnames"><span class="toc-number">1.16.</span> <span class="toc-text">classnames</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E6%8A%96%E5%A4%84%E7%90%86"><span class="toc-number">1.17.</span> <span class="toc-text">防抖处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#aHooks"><span class="toc-number">1.18.</span> <span class="toc-text">aHooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useDebounceFn"><span class="toc-number">1.18.1.</span> <span class="toc-text">useDebounceFn</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E4%BA%AE%E5%85%B3%E9%94%AE%E5%AD%97%E5%A4%84%E7%90%86"><span class="toc-number">1.19.</span> <span class="toc-text">高亮关键字处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#innerHTML"><span class="toc-number">1.20.</span> <span class="toc-text">innerHTML</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2-XSS-%E6%94%BB%E5%87%BB"><span class="toc-number">1.21.</span> <span class="toc-text">防 XSS 攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keep-alive-%E5%8A%9F%E8%83%BD"><span class="toc-number">1.22.</span> <span class="toc-text">keep-alive 功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86"><span class="toc-number">1.22.1.</span> <span class="toc-text">背景知识</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Diff-%E7%AE%97%E6%B3%95%E8%AF%B4%E6%98%8E"><span class="toc-number">1.23.</span> <span class="toc-text">Diff 算法说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#key-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.23.1.</span> <span class="toc-text">key 属性</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/a5ae354f.html" title="数组、字符串常用方法"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/js.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数组、字符串常用方法"/></a><div class="content"><a class="title" href="/posts/a5ae354f.html" title="数组、字符串常用方法">数组、字符串常用方法</a><time datetime="2022-11-24T02:24:11.000Z" title="发表于 2022-11-24 10:24:11">2022-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b0de96e1.html" title="CSS 总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/css.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CSS 总结"/></a><div class="content"><a class="title" href="/posts/b0de96e1.html" title="CSS 总结">CSS 总结</a><time datetime="2022-11-24T02:22:36.000Z" title="发表于 2022-11-24 10:22:36">2022-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f1991798.html" title="Git 总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/git.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git 总结"/></a><div class="content"><a class="title" href="/posts/f1991798.html" title="Git 总结">Git 总结</a><time datetime="2022-11-24T02:22:36.000Z" title="发表于 2022-11-24 10:22:36">2022-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/50b39724.html" title="HTML 总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/HTML.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTML 总结"/></a><div class="content"><a class="title" href="/posts/50b39724.html" title="HTML 总结">HTML 总结</a><time datetime="2022-11-24T02:22:36.000Z" title="发表于 2022-11-24 10:22:36">2022-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/588ad959.html" title="JS 基础总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../../../../img/React%20%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%80%BB%E7%BB%93/js.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JS 基础总结"/></a><div class="content"><a class="title" href="/posts/588ad959.html" title="JS 基础总结">JS 基础总结</a><time datetime="2022-11-24T02:22:36.000Z" title="发表于 2022-11-24 10:22:36">2022-11-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 随时奉陪</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script src="/js/weather.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>